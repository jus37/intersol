(function(t){function e(e){for(var a,i,o=e[0],c=e[1],u=e[2],p=0,h=[];p<o.length;p++)i=o[p],r[i]&&h.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(h.length)h.shift()();return n.push.apply(n,u||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,o=1;o<s.length;o++){var c=s[o];0!==r[c]&&(a=!1)}a&&(n.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},r={app:0},n=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var a=s("c21b"),r=s.n(a);r.a},"28ca":function(t,e,s){},"3a12":function(t,e,s){"use strict";var a=s("28ca"),r=s.n(a);r.a},4:function(t,e){},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("Layout",[s("Row",[s("Col",{staticClass:"main",attrs:{span:"14",offset:"2"}},[s("Chat")],1),s("Col",{staticClass:"main",attrs:{span:"6"}},[s("Users")],1)],1)],1)],1)},n=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[t.auth?t._e():s("Row",[s("Col",{staticClass:"auth-message",attrs:{span:"18",offset:"3"}},[s("h3",[t._v("Авторизуйтесь, чтобы начать общаться:")]),s("img",{attrs:{src:"https://pp.userapi.com/c852028/v852028593/14048/8LRgw-x56a8.jpg"},on:{click:t.vkAuth}})])],1),t.privateChat?s("div",{staticClass:"private-title"},[s("Icon",{attrs:{type:"ios-arrow-back",size:"40"},on:{click:t.closePrivateChat}}),s("img",{attrs:{src:t.privateChat.photo_50}}),s("h3",[t._v(t._s(t.privateChat.first_name)+" "+t._s(t.privateChat.last_name))])],1):t._e(),t.messages.length?t._e():s("h2",{staticStyle:{"text-align":"center","margin-top":"30px"}},[t._v("Здесь пока пусто ...")]),s("div",{staticClass:"chat"},t._l(t.messages,function(e){return s("div",{staticClass:"message"},[s("img",{attrs:{src:e.user.photo_50}}),s("div",{staticClass:"message-text"},[s("div",{staticClass:"message-author"},[t._v(t._s(e.user.first_name)+" "+t._s(e.user.last_name))]),s("div",{staticClass:"message-text"},[t._v(t._s(e.text))])]),s("div",[t._v("\n                "+t._s(t.getMessageDate(e.date))+"\n            ")])])})),s("Input",{ref:"input",attrs:{suffix:"md-send",placeholder:"Сообщение",autofocus:""},on:{"on-enter":t.sendMessage},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)},o=[],c=s("b9b9"),u=s.n(c);function l(t){let e={};return t.split(";").forEach(function(t){var s=t.split("=");e[s.shift()]=unescape(s.join("="))}),e}var p={name:"Chat",data(){return{auth:!1,message:null}},mounted(){this.chatContainer=document.querySelector(".chat")},created(){const t=l(document.cookie);this.auth=!!t.user},methods:{vkAuth(){window.location.replace("/vkauth")},sendMessage(){this.message&&(this.message=this.message.trim(),this.$socket.emit("message",{chat:this.privateChat,text:this.message}),this.message=null)},closePrivateChat(){this.$store.commit("setPrivateChat",null)},getMessageDate(t){return u()(t,"HH:MM dd.mm.yy")}},updated(){this.chatContainer.scrollTo(0,this.chatContainer.scrollHeight)},computed:{messages(){return this.$store.state.messages},privateChat(){const t=this.$store.state.privateChat;return this.$store.commit("setMessages",[]),this.$socket.emit("messagesHistory",t),this.$refs.input&&this.$refs.input.focus(),t}}},h=p,f=(s("3a12"),s("2877")),m=Object(f["a"])(h,i,o,!1,null,"0c14d96f",null);m.options.__file="Chat.vue";var v=m.exports,d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("h3",[t._v("Online:")]),t._l(t.users,function(e){return s("div",{staticClass:"user",on:{click:function(s){t.selectUser(e)}}},[s("img",{attrs:{src:e.photo_50}}),s("div",[t._v(t._s(e.first_name)+" "+t._s(e.last_name))])])})],2)},g=[],_={name:"Users",computed:{users(){return this.$store.state.users}},methods:{selectUser(t){this.$store.commit("setPrivateChat",t)}}},C=_,b=(s("6880"),Object(f["a"])(C,d,g,!1,null,"138e83e9",null));b.options.__file="Users.vue";var y=b.exports,w={name:"app",components:{Users:y,Chat:v}},x=w,$=(s("034f"),Object(f["a"])(x,r,n,!1,null,null,null));$.options.__file="App.vue";var k=$.exports,M=s("2f62");a["default"].use(M["a"]);var j=new M["a"].Store({state:{privateChat:null,messages:[],users:[]},mutations:{setMessages(t,e){t.messages=e},pushMessage(t,e){t.messages.push(e)},setPrivateChat(t,e){t.privateChat=e},setUsers(t,e){t.users=e}}}),O=s("8055"),P=s.n(O);const S="",U={install(t,e,s){const a=P()(S);t.prototype.$socket=a,a.on("users",t=>{e.commit("setUsers",t)}),a.on("messagesHistory",t=>{e.commit("setMessages",t)}),a.on("message",t=>{e.commit("pushMessage",t)}),a.on("error",e=>{t.prototype.$Notice.warning({title:"Ошибка",desc:e.error})})}};var H=U,E=s("e069"),T=s.n(E),A=s("452b"),R=s.n(A);s("dcad");a["default"].use(T.a,{locale:R.a}),a["default"].config.productionTip=!1,a["default"].use(H,j),new a["default"]({store:j,render:t=>t(k)}).$mount("#app")},6880:function(t,e,s){"use strict";var a=s("e2d7"),r=s.n(a);r.a},c21b:function(t,e,s){},e2d7:function(t,e,s){}});
//# sourceMappingURL=app.6e8620dd.js.map